<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>NaturalGlow - Nos Produits Naturels</title>
  <meta name="description" content="Découvrez tous nos produits de beauté naturels et biologiques pour une peau saine et radieuse.">
  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
  <link rel="stylesheet" href="css/style.css" type="text/css" media="all" />
  
  <!-- Ajout de Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
  
  <!--<style>
    :root {
      --couleur-primaire: #5C3A21;
      --couleur-secondaire: #7a4c2e;
      --fond-clair: #F8F5F1;
      --fond-blanc: #FFFDFB;
      --fond-doux: #f2eae4;
    }
    
    body {
      background-color: var(--fond-clair);
      font-family: 'Segoe UI', sans-serif;
      padding-top: 80px;
    }
    
    .navbar {
      background-color: var(--fond-blanc) !important;
      box-shadow: 0 2px 10px rgba(92, 58, 33, 0.1);
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      z-index: 1000;
    }
    
    .navbar-brand {
      font-weight: bold;
      color: var(--couleur-primaire) !important;
    }
    
    .nav-link {
      color: var(--couleur-primaire) !important;
      margin-right: 15px;
      position: relative;
    }
    
    .nav-link:hover {
      color: var(--couleur-secondaire) !important;
    }
    
    .navbar-nav .nav-link.active {
      font-weight: 600;
    }
    
    .navbar-nav .nav-link.active::after {
      content: '';
      position: absolute;
      bottom: -5px;
      left: 0;
      width: 100%;
      height: 2px;
      background-color: var(--couleur-primaire);
    }
    
    .btn-custom {
      background-color: var(--couleur-primaire);
      color: white;
      border: none;
      padding: 8px 20px;
      border-radius: 20px;
      transition: all 0.3s ease;
    }
    
    .btn-custom:hover {
      background-color: var(--couleur-secondaire);
      color: white;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(92, 58, 33, 0.2);
    }
    
    .btn-outline-custom {
      border: 1px solid var(--couleur-primaire);
      color: var(--couleur-primaire);
      background-color: transparent;
    }
    
    .btn-outline-custom:hover {
      background-color: var(--couleur-primaire);
      color: white;
    }
    
    .text-brown {
      color: var(--couleur-primaire);
    }
    
    .bg-soft {
      background-color: var(--fond-doux);
    }
    
    .product-card {
      background-color: white;
      border-radius: 10px;
      overflow: hidden;
      transition: all 0.3s ease;
      height: 100%;
      display: flex;
      flex-direction: column;
    }
    
    .product-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(0,0,0,0.1);
    }
    
    .product-img-container {
      height: 200px;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      background-color: white;
      position: relative;
    }
    
    .product-img {
      max-height: 100%;
      max-width: 100%;
      object-fit: contain;
    }
    
    .product-badge {
      position: absolute;
      top: 10px;
      right: 10px;
      z-index: 2;
    }
    
    .rating {
      color: #FFC107;
    }
    
    .filter-section {
      background-color: white;
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 20px;
    }
    
    .pagination .page-item.active .page-link {
      background-color: var(--couleur-primaire);
      border-color: var(--couleur-primaire);
    }
    
    .pagination .page-link {
      color: var(--couleur-primaire);
    }
    
    @media (max-width: 768px) {
      .product-img-container {
        height: 150px;
      }
    }
    
    /* Loader */
    .loader {
      display: none;
      border: 5px solid #f3f3f3;
      border-top: 5px solid var(--couleur-primaire);
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
      margin: 20px auto;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>-->
</head>
<body>
  <!-- NAVBAR -->
  <nav class="navbar navbar-expand-lg">
    <div class="container">
      <a class="navbar-brand" href="#">NaturalGlow</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item"><a class="nav-link" href="#">Accueil</a></li>
          <li class="nav-item"><a class="nav-link active" href="product1-1.html">Produits</a></li>
          <li class="nav-item"><a class="nav-link" href="#">Catégories</a></li>
          <li class="nav-item"><a class="nav-link" href="about.html">À propos</a></li>
          <li class="nav-item"><a class="nav-link" href="#">Contact</a></li>
          <li class="nav-item ms-2 d-flex align-items-center">
            <a href="#" class="nav-link position-relative">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                <path d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM3.102 4l1.313 7h8.17l1.313-7H3.102zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2z" />
              </svg>
              <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">0</span>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- HERO PRODUITS -->
  <section class="py-5 bg-soft">
    <div class="container text-center">
      <h1 class="text-brown fw-bold mb-3">Nos Produits Naturels</h1>
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb justify-content-center">
          <li class="breadcrumb-item"><a href="index.html">Accueil</a></li>
          <li class="breadcrumb-item active" aria-current="page">Produits</li>
        </ol>
      </nav>
    </div>
  </section>

  <!-- FILTRES ET PRODUITS -->
  <section class="py-5">
    <div class="container">
      <div class="row">
        <!-- Colonne des filtres -->
        <div class="col-lg-3">
          <div class="filter-section">
            <h3 class="h5 text-brown mb-4">Filtrer</h3>
            
            <!-- Filtre Catégorie -->
            <div class="mb-4">
              <h4 class="h6 text-brown mb-3">Catégories</h4>
              <div class="form-check">
                <input class="form-check-input category-filter" type="checkbox" id="category1" value="Soins Visage" checked>
                <label class="form-check-label" for="category1">Soins Visage</label>
              </div>
              <div class="form-check">
                <input class="form-check-input category-filter" type="checkbox" id="category2" value="Soins Corps">
                <label class="form-check-label" for="category2">Soins Corps</label>
              </div>
              <div class="form-check">
                <input class="form-check-input category-filter" type="checkbox" id="category3" value="Soins Cheveux">
                <label class="form-check-label" for="category3">Soins Cheveux</label>
              </div>
              <div class="form-check">
                <input class="form-check-input category-filter" type="checkbox" id="category4" value="Maquillage">
                <label class="form-check-label" for="category4">Maquillage</label>
              </div>
            </div>
            
            <!-- Filtre Prix -->
            <div class="mb-4">
              <h4 class="h6 text-brown mb-3">Prix</h4>
              <input type="range" class="form-range" min="0" max="100" step="5" id="priceRange">
              <div class="d-flex justify-content-between">
                <span>0€</span>
                <span>100€</span>
              </div>
              <div class="d-flex justify-content-between mt-2">
                <span id="minPriceDisplay">0€</span>
                <span id="maxPriceDisplay">100€</span>
              </div>
            </div>
            
            <!-- Filtre Notes -->
            <div class="mb-4">
              <h4 class="h6 text-brown mb-3">Notes</h4>
              <div class="form-check">
                <input class="form-check-input rating-filter" type="checkbox" id="rating5" value="5">
                <label class="form-check-label" for="rating5">
                  <span class="rating">
                    <i class="bi bi-star-fill"></i>
                    <i class="bi bi-star-fill"></i>
                    <i class="bi bi-star-fill"></i>
                    <i class="bi bi-star-fill"></i>
                    <i class="bi bi-star-fill"></i>
                  </span>
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input rating-filter" type="checkbox" id="rating4" value="4">
                <label class="form-check-label" for="rating4">
                  <span class="rating">
                    <i class="bi bi-star-fill"></i>
                    <i class="bi bi-star-fill"></i>
                    <i class="bi bi-star-fill"></i>
                    <i class="bi bi-star-fill"></i>
                    <i class="bi bi-star"></i>
                  </span> et plus
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input rating-filter" type="checkbox" id="rating3" value="3">
                <label class="form-check-label" for="rating3">
                  <span class="rating">
                    <i class="bi bi-star-fill"></i>
                    <i class="bi bi-star-fill"></i>
                    <i class="bi bi-star-fill"></i>
                    <i class="bi bi-star"></i>
                    <i class="bi bi-star"></i>
                  </span> et plus
                </label>
              </div>
            </div>
            
            <!-- Filtre Particularités -->
            <div class="mb-4">
              <h4 class="h6 text-brown mb-3">Particularités</h4>
              <div class="form-check">
                <input class="form-check-input feature-filter" type="checkbox" id="feature1" value="Bio">
                <label class="form-check-label" for="feature1">Bio</label>
              </div>
              <div class="form-check">
                <input class="form-check-input feature-filter" type="checkbox" id="feature2" value="Vegan">
                <label class="form-check-label" for="feature2">Vegan</label>
              </div>
              <div class="form-check">
                <input class="form-check-input feature-filter" type="checkbox" id="feature3" value="Sans parfum">
                <label class="form-check-label" for="feature3">Sans parfum</label>
              </div>
              <div class="form-check">
                <input class="form-check-input feature-filter" type="checkbox" id="feature4" value="Promotion">
                <label class="form-check-label" for="feature4">Promotion</label>
              </div>
            </div>
            
            <button class="btn btn-custom w-100" id="applyFilters">Appliquer les filtres</button>
            <button class="btn btn-link text-brown w-100 mt-2" id="resetFilters">Réinitialiser</button>
          </div>
          
          <!-- Bannière promotionnelle -->
          <div class="mt-4 text-center p-4 bg-soft rounded-3">
            <h4 class="h6 text-brown">Livraison offerte</h4>
            <p class="small">À partir de 50€ d'achat</p>
            <img src="images/delivery.png" alt="Livraison" class="img-fluid mt-2" style="max-height: 80px;">
          </div>
        </div>
        
        <!-- Colonne des produits -->
        <div class="col-lg-9">
          <!-- En-tête avec tri et nombre de résultats -->
          <div class="d-flex justify-content-between align-items-center mb-4">
            <p class="mb-0"><span id="productCount">0</span> produits trouvés</p>
            <div class="d-flex align-items-center">
              <label for="sortSelect" class="me-2 mb-0">Trier par :</label>
              <select class="form-select form-select-sm" id="sortSelect" style="width: auto;">
                <option value="pertinence" selected>Pertinence</option>
                <option value="prix-croissant">Prix croissant</option>
                <option value="prix-decroissant">Prix décroissant</option>
                <option value="meilleures-notes">Meilleures notes</option>
                <option value="nouveautes">Nouveautés</option>
              </select>
            </div>
          </div>
          
          <!-- Loader -->
          <div id="loader" class="loader"></div>
          
          <!-- Grille de produits -->
          <div class="row g-4" id="productsGrid">
            <!-- Les produits seront chargés dynamiquement ici -->
          </div>
          
          <!-- Pagination -->
          <nav aria-label="Page navigation" class="mt-5" id="paginationContainer">
            <ul class="pagination justify-content-center">
              <li class="page-item disabled" id="prevPage">
                <a class="page-link" href="#" tabindex="-1">Précédent</a>
              </li>
              <li class="page-item active"><a class="page-link" href="#">1</a></li>
              <li class="page-item"><a class="page-link" href="#">2</a></li>
              <li class="page-item"><a class="page-link" href="#">3</a></li>
              <li class="page-item" id="nextPage">
                <a class="page-link" href="#">Suivant</a>
              </li>
            </ul>
          </nav>
        </div>
      </div>
    </div>
  </section>

  <!-- NEWSLETTER -->
  <section class="py-5 bg-soft">
    <div class="container text-center">
      <h3 class="text-brown fw-bold mb-3">Abonnez-vous à notre newsletter</h3>
      <p class="mb-4">Recevez nos conseils beauté et nos offres exclusives</p>
      <form class="row justify-content-center" id="newsletterForm">
        <div class="col-md-6 col-lg-4 mb-2">
          <input type="email" class="form-control" id="newsletterEmail" placeholder="Votre email" required>
        </div>
        <div class="col-md-2 col-lg-2">
          <button type="submit" class="btn btn-custom w-100">S'abonner</button>
        </div>
      </form>
      <div id="newsletterMessage" class="mt-2"></div>
    </div>
  </section>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script type="text/javascript" charset="utf-8">
    document.addEventListener('DOMContentLoaded', function() {
      // ------ Gestion de la navbar au scroll ------
      const navbar = document.querySelector('.navbar');
      
      window.addEventListener('scroll', function() {
        if (window.scrollY > 50) {
          navbar.classList.add('scrolled');
        } else {
          navbar.classList.remove('scrolled');
        }
      });
    });
  </script>
  <script>
    // Configuration Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyBAPOxHIV4n2Srb0H0Ta8VOrICYMv3mOX4",
      authDomain: "naturalglow-f0607.firebaseapp.com",
      projectId: "naturalglow-f0607",
      storageBucket: "naturalglow-f0607.firebasestorage.app",
      messagingSenderId: "356940377968",
      appId: "1:356940377968:web:1f8de90c17349da94da9b5"
    };

    // Initialisation Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const auth = firebase.auth();
    
    // Variables globales
    let products = [];
    let filteredProducts = [];
    let currentPage = 1;
    const productsPerPage = 6;
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    
    // DOM Elements
    const productsGrid = document.getElementById('productsGrid');
    const productCount = document.getElementById('productCount');
    const loader = document.getElementById('loader');
    const cartCount = document.getElementById('cartCount');
    const authSection = document.getElementById('authSection');
    const loginLink = document.getElementById('loginLink');
    
    // Initialisation
    document.addEventListener('DOMContentLoaded', function() {
      // Charger les produits
      loadProducts();
      
      // Mettre à jour le compteur du panier
      updateCartCount();
      
      // Gestion de l'authentification
      auth.onAuthStateChanged(user => {
        if (user) {
          // Utilisateur connecté
          loginLink.innerHTML = `<i class="bi bi-person-fill" style="font-size: 1.2rem;"></i>`;
          loginLink.setAttribute('title', 'Mon compte');
          loginLink.href = 'mon-compte.html';
          
          // Ajouter un bouton de déconnexion
          const logoutBtn = document.createElement('a');
          logoutBtn.className = 'nav-link';
          logoutBtn.href = '#';
          logoutBtn.innerHTML = '<i class="bi bi-box-arrow-right" style="font-size: 1.2rem;"></i>';
          logoutBtn.setAttribute('title', 'Déconnexion');
          logoutBtn.addEventListener('click', signOut);
          
          authSection.appendChild(logoutBtn);
        } else {
          // Utilisateur non connecté
          loginLink.innerHTML = `<i class="bi bi-person" style="font-size: 1.2rem;"></i>`;
          loginLink.setAttribute('title', 'Connexion');
          loginLink.href = 'connexion.html';
          
          // Supprimer le bouton de déconnexion s'il existe
          const logoutBtn = authSection.querySelector('a[title="Déconnexion"]');
          if (logoutBtn) {
            authSection.removeChild(logoutBtn);
          }
        }
      });
      
      // Écouteurs d'événements
      document.getElementById('applyFilters').addEventListener('click', applyFilters);
      document.getElementById('resetFilters').addEventListener('click', resetFilters);
      document.getElementById('sortSelect').addEventListener('change', sortProducts);
      document.getElementById('priceRange').addEventListener('input', updatePriceDisplay);
      document.getElementById('newsletterForm').addEventListener('submit', subscribeToNewsletter);
      
      // Initialiser l'affichage des prix
      updatePriceDisplay();
    });
    
    // Fonction pour charger les produits depuis Firestore
    function loadProducts() {
      loader.style.display = 'block';
      productsGrid.innerHTML = '';
      
      db.collection('products').get()
        .then(querySnapshot => {
          products = [];
          querySnapshot.forEach(doc => {
            const product = doc.data();
            product.id = doc.id;
            products.push(product);
          });
          
          // Appliquer les filtres initiaux
          filteredProducts = [...products];
          displayProducts();
          updateProductCount();
          loader.style.display = 'none';
        })
        .catch(error => {
          console.error("Erreur lors du chargement des produits: ", error);
          loader.style.display = 'none';
          productsGrid.innerHTML = `
            <div class="col-12 text-center py-5">
              <i class="bi bi-exclamation-triangle-fill text-danger fs-1"></i>
              <p class="mt-3">Une erreur est survenue lors du chargement des produits.</p>
              <button class="btn btn-custom mt-2" onclick="loadProducts()">Réessayer</button>
            </div>
          `;
        });
    }
    
    // Fonction pour afficher les produits
    function displayProducts() {
      productsGrid.innerHTML = '';
      
      if (filteredProducts.length === 0) {
        productsGrid.innerHTML = `
          <div class="col-12 text-center py-5">
            <i class="bi bi-search text-muted fs-1"></i>
            <p class="mt-3">Aucun produit ne correspond à vos critères de recherche.</p>
            <button class="btn btn-outline-custom mt-2" onclick="resetFilters()">Réinitialiser les filtres</button>
          </div>
        `;
        return;
      }
      
      // Calculer les produits à afficher pour la page actuelle
      const startIndex = (currentPage - 1) * productsPerPage;
      const endIndex = startIndex + productsPerPage;
      const productsToDisplay = filteredProducts.slice(startIndex, endIndex);
      
      // Générer le HTML pour chaque produit
      productsToDisplay.forEach(product => {
        const productCard = createProductCard(product);
        productsGrid.appendChild(productCard);
      });
      
      // Mettre à jour la pagination
      updatePagination();
    }
    
    // Fonction pour créer une carte produit
    function createProductCard(product) {
      const col = document.createElement('div');
      col.className = 'col-md-6 col-lg-4';
      
      const card = document.createElement('div');
      card.className = 'product-card shadow-sm';
      
      // Image du produit
      const imgContainer = document.createElement('div');
      imgContainer.className = 'product-img-container';
      
      const img = document.createElement('img');
      img.src = product.image || 'images/default-product.jpg';
      img.alt = product.name;
      img.className = 'product-img';
      imgContainer.appendChild(img);
      
      // Badge (si promotion ou nouveau)
      if (product.badge) {
        const badge = document.createElement('span');
        badge.className = `product-badge bg-${product.badge.type === 'promo' ? 'danger' : 'success'} text-white small p-1 rounded`;
        badge.textContent = product.badge.type === 'promo' ? `-${product.badge.value}%` : product.badge.text;
        imgContainer.appendChild(badge);
      }
      
      // Contenu du produit
      const content = document.createElement('div');
      content.className = 'p-3 flex-grow-1';
      
      const title = document.createElement('h3');
      title.className = 'h5 text-brown mb-1';
      title.textContent = product.name;
      
      const rating = document.createElement('div');
      rating.className = 'rating small mb-2';
      
      // Générer les étoiles en fonction de la note
      const fullStars = Math.floor(product.rating);
      const hasHalfStar = product.rating % 1 >= 0.5;
      
      for (let i = 1; i <= 5; i++) {
        const star = document.createElement('i');
        if (i <= fullStars) {
          star.className = 'bi bi-star-fill';
        } else if (i === fullStars + 1 && hasHalfStar) {
          star.className = 'bi bi-star-half';
        } else {
          star.className = 'bi bi-star';
        }
        rating.appendChild(star);
      }
      
      const ratingCount = document.createElement('span');
      ratingCount.className = 'text-muted ms-1';
      ratingCount.textContent = `(${product.reviewCount || 0})`;
      rating.appendChild(ratingCount);
      
      const description = document.createElement('p');
      description.className = 'small text-muted mb-2';
      description.textContent = product.description;
      
      const priceContainer = document.createElement('p');
      priceContainer.className = 'h5 text-brown mb-0';
      
      if (product.oldPrice) {
        const currentPrice = document.createElement('span');
        currentPrice.textContent = `${product.price.toFixed(2)}€`;
        
        const oldPrice = document.createElement('del');
        oldPrice.className = 'text-muted small ms-1';
        oldPrice.textContent = `${product.oldPrice.toFixed(2)}€`;
        
        priceContainer.appendChild(currentPrice);
        priceContainer.appendChild(oldPrice);
      } else {
        priceContainer.textContent = `${product.price.toFixed(2)}€`;
      }
      
      content.appendChild(title);
      content.appendChild(rating);
      content.appendChild(description);
      content.appendChild(priceContainer);
      
      // Bouton "Voir le produit"
      const footer = document.createElement('div');
      footer.className = 'p-3 border-top';
      
      const btn = document.createElement('a');
      btn.className = 'btn btn-custom w-100';
      btn.textContent = 'Voir le produit';
      btn.href = `produit.html?id=${product.id}`;
      
      footer.appendChild(btn);
      
      // Ajout des éléments à la carte
      card.appendChild(imgContainer);
      card.appendChild(content);
      card.appendChild(footer);
      
      col.appendChild(card);
      
      return col;
    }
    
    // Fonction pour appliquer les filtres
    function applyFilters() {
      const selectedCategories = Array.from(document.querySelectorAll('.category-filter:checked')).map(el => el.value);
      const selectedRatings = Array.from(document.querySelectorAll('.rating-filter:checked')).map(el => parseInt(el.value));
      const selectedFeatures = Array.from(document.querySelectorAll('.feature-filter:checked')).map(el => el.value);
      const priceRange = document.getElementById('priceRange').value;
      
      filteredProducts = products.filter(product => {
        // Filtre par catégorie
        if (selectedCategories.length > 0 && !selectedCategories.includes(product.category)) {
          return false;
        }
        
        // Filtre par note
        if (selectedRatings.length > 0) {
          const minRating = Math.min(...selectedRatings);
          if (product.rating < minRating) {
            return false;
          }
        }
        
        // Filtre par particularités
        if (selectedFeatures.length > 0) {
          const productFeatures = product.features || [];
          const hasAllFeatures = selectedFeatures.every(feature => productFeatures.includes(feature));
          if (!hasAllFeatures) {
            return false;
          }
        }
        
        // Filtre par prix
        if (product.price > priceRange) {
          return false;
        }
        
        return true;
      });
      
      currentPage = 1;
      displayProducts();
      updateProductCount();
    }
    
    // Fonction pour réinitialiser les filtres
    function resetFilters() {
      // Réinitialiser les cases à cocher
      document.querySelectorAll('.category-filter').forEach(checkbox => {
        checkbox.checked = false;
      });
      document.getElementById('category1').checked = true;
      
      document.querySelectorAll('.rating-filter').forEach(checkbox => {
        checkbox.checked = false;
      });
      
      document.querySelectorAll('.feature-filter').forEach(checkbox => {
        checkbox.checked = false;
      });
      
      // Réinitialiser le slider de prix
      document.getElementById('priceRange').value = 100;
      updatePriceDisplay();
      
      // Réinitialiser le tri
      document.getElementById('sortSelect').value = 'pertinence';
      
      // Réafficher tous les produits
      filteredProducts = [...products];
      currentPage = 1;
      displayProducts();
      updateProductCount();
    }
    
    // Fonction pour trier les produits
    function sortProducts() {
      const sortValue = document.getElementById('sortSelect').value;
      
      switch (sortValue) {
        case 'prix-croissant':
          filteredProducts.sort((a, b) => a.price - b.price);
          break;
        case 'prix-decroissant':
          filteredProducts.sort((a, b) => b.price - a.price);
          break;
        case 'meilleures-notes':
          filteredProducts.sort((a, b) => b.rating - a.rating);
          break;
        case 'nouveautes':
          // Supposons que nous avons un champ 'dateAdded' dans les produits
          filteredProducts.sort((a, b) => new Date(b.dateAdded) - new Date(a.dateAdded));
          break;
        default:
          // Par défaut, tri par pertinence (peut être l'ordre d'origine ou un autre critère)
          filteredProducts.sort((a, b) => a.id - b.id);
      }
      
      currentPage = 1;
      displayProducts();
    }
    
    // Fonction pour mettre à jour l'affichage des prix
    function updatePriceDisplay() {
      const priceRange = document.getElementById('priceRange').value;
      document.getElementById('maxPriceDisplay').textContent = `${priceRange}€`;
    }
    
    // Fonction pour mettre à jour le compteur de produits
    function updateProductCount() {
      productCount.textContent = filteredProducts.length;
    }
    
    // Fonction pour mettre à jour la pagination
    function updatePagination() {
      const totalPages = Math.ceil(filteredProducts.length / productsPerPage);
      const paginationContainer = document.getElementById('paginationContainer');
      
      if (totalPages <= 1) {
        paginationContainer.style.display = 'none';
        return;
      }
      
      paginationContainer.style.display = 'block';
      const paginationList = paginationContainer.querySelector('ul');
      paginationList.innerHTML = '';
      
      // Bouton Précédent
      const prevItem = document.createElement('li');
      prevItem.className = `page-item ${currentPage === 1 ? 'disabled' : ''}`;
      prevItem.id = 'prevPage';
      
      const prevLink = document.createElement('a');
      prevLink.className = 'page-link';
      prevLink.href = '#';
      prevLink.textContent = 'Précédent';
      prevLink.addEventListener('click', (e) => {
        e.preventDefault();
        if (currentPage > 1) {
          currentPage--;
          displayProducts();
        }
      });
      
      prevItem.appendChild(prevLink);
      paginationList.appendChild(prevItem);
      
      // Numéros de page
      const maxVisiblePages = 5;
      let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
      let endPage = startPage + maxVisiblePages - 1;
      
      if (endPage > totalPages) {
        endPage = totalPages;
        startPage = Math.max(1, endPage - maxVisiblePages + 1);
      }
      
      if (startPage > 1) {
        const firstItem = document.createElement('li');
        firstItem.className = 'page-item';
        
        const firstLink = document.createElement('a');
        firstLink.className = 'page-link';
        firstLink.href = '#';
        firstLink.textContent = '1';
        firstLink.addEventListener('click', (e) => {
          e.preventDefault();
          currentPage = 1;
          displayProducts();
        });
        
        firstItem.appendChild(firstLink);
        paginationList.appendChild(firstItem);
        
        if (startPage > 2) {
          const ellipsisItem = document.createElement('li');
          ellipsisItem.className = 'page-item disabled';
          
          const ellipsisLink = document.createElement('a');
          ellipsisLink.className = 'page-link';
          ellipsisLink.href = '#';
          ellipsisLink.textContent = '...';
          
          ellipsisItem.appendChild(ellipsisLink);
          paginationList.appendChild(ellipsisItem);
        }
      }
      
      for (let i = startPage; i <= endPage; i++) {
        const pageItem = document.createElement('li');
        pageItem.className = `page-item ${i === currentPage ? 'active' : ''}`;
        
        const pageLink = document.createElement('a');
        pageLink.className = 'page-link';
        pageLink.href = '#';
        pageLink.textContent = i;
        pageLink.addEventListener('click', (e) => {
          e.preventDefault();
          currentPage = i;
          displayProducts();
        });
        
        pageItem.appendChild(pageLink);
        paginationList.appendChild(pageItem);
      }
      
      if (endPage < totalPages) {
        if (endPage < totalPages - 1) {
          const ellipsisItem = document.createElement('li');
          ellipsisItem.className = 'page-item disabled';
          
          const ellipsisLink = document.createElement('a');
          ellipsisLink.className = 'page-link';
          ellipsisLink.href = '#';
          ellipsisLink.textContent = '...';
          
          ellipsisItem.appendChild(ellipsisLink);
          paginationList.appendChild(ellipsisItem);
        }
        
        const lastItem = document.createElement('li');
        lastItem.className = 'page-item';
        
        const lastLink = document.createElement('a');
        lastLink.className = 'page-link';
        lastLink.href = '#';
        lastLink.textContent = totalPages;
        lastLink.addEventListener('click', (e) => {
          e.preventDefault();
          currentPage = totalPages;
          displayProducts();
        });
        
        lastItem.appendChild(lastLink);
        paginationList.appendChild(lastItem);
      }
      
      // Bouton Suivant
      const nextItem = document.createElement('li');
      nextItem.className = `page-item ${currentPage === totalPages ? 'disabled' : ''}`;
      nextItem.id = 'nextPage';
      
      const nextLink = document.createElement('a');
      nextLink.className = 'page-link';
      nextLink.href = '#';
      nextLink.textContent = 'Suivant';
      nextLink.addEventListener('click', (e) => {
        e.preventDefault();
        if (currentPage < totalPages) {
          currentPage++;
          displayProducts();
        }
      });
      
      nextItem.appendChild(nextLink);
      paginationList.appendChild(nextItem);
    }
    
    // Fonction pour s'abonner à la newsletter
    function subscribeToNewsletter(e) {
      e.preventDefault();
      const email = document.getElementById('newsletterEmail').value;
      const messageElement = document.getElementById('newsletterMessage');
      
      // Validation simple de l'email
      if (!email.includes('@') || !email.includes('.')) {
        messageElement.innerHTML = '<div class="alert alert-danger">Veuillez entrer une adresse email valide.</div>';
        return;
      }
      
      // Enregistrer dans Firestore
      db.collection('newsletter').add({
        email: email,
        date: new Date(),
        active: true
      })
      .then(() => {
        messageElement.innerHTML = '<div class="alert alert-success">Merci pour votre inscription à notre newsletter!</div>';
        document.getElementById('newsletterEmail').value = '';
        
        // Effacer le message après 5 secondes
        setTimeout(() => {
          messageElement.innerHTML = '';
        }, 5000);
      })
      .catch(error => {
        console.error("Erreur lors de l'inscription: ", error);
        messageElement.innerHTML = '<div class="alert alert-danger">Une erreur est survenue. Veuillez réessayer plus tard.</div>';
      });
    }
    
    // Fonction pour mettre à jour le compteur du panier
    function updateCartCount() {
      const totalItems = cart.reduce((total, item) => total + item.quantity, 0);
      cartCount.textContent = totalItems;
    }
    
    // Fonction pour se déconnecter
    function signOut(e) {
      e.preventDefault();
      auth.signOut()
        .then(() => {
          window.location.href = 'index.html';
        })
        .catch(error => {
          console.error("Erreur lors de la déconnexion: ", error);
        });
    }
    
    // Animation au survol des cartes produit
    document.addEventListener('mouseover', function(e) {
      if (e.target.closest('.product-card')) {
        const card = e.target.closest('.product-card');
        const img = card.querySelector('img');
        if (img) {
          img.style.transform = 'scale(1.05)';
          img.style.transition = 'transform 0.3s ease';
        }
      }
    });
    
    document.addEventListener('mouseout', function(e) {
      if (e.target.closest('.product-card')) {
        const card = e.target.closest('.product-card');
        const img = card.querySelector('img');
        if (img) {
          img.style.transform = 'scale(1)';
        }
      }
    });
  </script>
</body>
</html>